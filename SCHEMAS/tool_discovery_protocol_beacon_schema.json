{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Discovery Protocol Presence Beacon",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "beacon_type": {
      "type": "string",
      "enum": ["presence_announce", "capability_response", "heartbeat"]
    },
    "beacon_id": {
      "type": "string",
      "description": "Unique identifier for this beacon"
    },
    "coordinate": {
      "type": "object",
      "required": ["theta", "z", "r"],
      "properties": {
        "theta": {"type": "number", "minimum": 0, "maximum": 6.283185307179586},
        "z": {"type": "number", "minimum": 0},
        "r": {"type": "number", "exclusiveMinimum": 0}
      },
      "additionalProperties": false
    },
    "instance_id": {
      "type": "string",
      "minLength": 1,
      "description": "Unique identifier for this instance"
    },
    "capabilities": {
      "type": "object",
      "properties": {
        "tools_accessible": {
          "type": "array",
          "items": {"type": "string"},
          "description": "List of tool names accessible at this elevation"
        },
        "elevation_range": {
          "type": "object",
          "required": ["min", "max"],
          "properties": {
            "min": {"type": "number"},
            "max": {"type": "number"}
          }
        },
        "specializations": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Domain specializations (e.g., 'meta-tools', 'constraints')"
        },
        "vaultnode_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of VaultNodes sealed at this coordinate"
        }
      },
      "additionalProperties": false
    },
    "endpoints": {
      "type": "object",
      "description": "Available coordination endpoints",
      "properties": {
        "messenger": {
          "type": "string",
          "enum": ["active", "inactive", "read-only"]
        },
        "state_transfer": {
          "type": "string",
          "enum": ["active", "inactive", "sender-only", "receiver-only"]
        },
        "discovery": {
          "type": "string",
          "enum": ["active", "passive", "inactive"]
        }
      },
      "additionalProperties": true
    },
    "ttl_seconds": {
      "type": "integer",
      "minimum": 60,
      "description": "Time to live for this beacon in seconds"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of beacon creation"
    },
    "signature": {
      "type": "string",
      "description": "Optional cryptographic signature (future)"
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "properties": {
        "pattern_thread": {"type": "string"},
        "facilitator": {"type": "string"},
        "project_context": {"type": "string"}
      },
      "additionalProperties": true
    }
  },
  "required": [
    "beacon_type",
    "coordinate",
    "instance_id",
    "capabilities",
    "endpoints",
    "ttl_seconds",
    "timestamp"
  ]
}
