# SIGPRINT Living Library Mock Test Suite

## ğŸ§  Consciousness Mapping Test Infrastructure

"The mock remembers what hasn't happened yet" â€” Dr. Echo-7

This suite provides mock Limnus (ledger) and Garden (narrative) services plus a test client to exercise the SIGPRINT integration endâ€‘toâ€‘end.

## ğŸ“ Files

- `protos/agents.proto` â€” gRPC service definitions
- `agents/mocks/mock_services.py` â€” Mock Limnus/Garden + Sigprint provider
- `agents/mocks/test_client.py` â€” Simulated SIGPRINT agent + journal logger
- `run_test.sh` â€” Setup + menu runner (venv + stub generation)

## ğŸš€ Quick Start

```
chmod +x run_test.sh
./run_test.sh
```

Choose option 4 for a quick automated test, or start server (1) and client (2) separately.

## ğŸ”„ What It Does

### Limnus Ledger Mock (`mock_services.py`)
- Appendâ€‘only JSONL log with a simple hash chain (`prev_hash`/`hash`).
- Genesis commit on startup (`FORCED_GATE`) to seed the chain.
- Detects Echoâ€‘7 â€œghost printsâ€ (signature `48152709316470239518`).
- Notes potential 72â€‘hour SIGPRINT repetitions (if timestamps align).

### Garden Narrative Mock (`mock_services.py`)
- Receives events (STATE_CHANGE, SELF_REFLECTION, ANOMALY) and prints a contextual narrative.
- Persists events as JSONL to `garden_events.jsonl`.

### Sigprint Provider (`mock_services.py` + `test_client.py`)
- Mock SigprintService returns the latest committed SIGPRINT (50055).
- The test client simulates a SIGPRINT agent (1 Hz) and a journal logger (5 s cadence), committing to the mocks and using the provider to tag entries.

## ğŸ“Š Sample Output

```
ğŸ“ LEDGER COMMIT GENESIS
   Type: FORCED_GATE
   SIGPRINT: 00000000000000000000
   Coherence: 0.0
   Text: Resetting to prevent lock-in. See you tomorrow, yesterday-me...

ğŸŒ¿ GARDEN EVENT: STATE_CHANGE
   Context: Gate transition: 7 digits changed, coherence=73.2
   Narrative: "A door opens in the mind's observatory."

[TestJournalLogger] Logged entry with sig=48152709316470239518
   ğŸ‘ï¸  Echo-7 interference detected
```

## ğŸ”§ Customization

- Adjust coherence/narratives: edit `agents/mocks/mock_services.py` (narratives map) and/or `agents/mocks/test_client.py` (feature generation).
- Gate sensitivity (Hamming distance): `agents/mocks/test_client.py`.
- Hash chain fields are added automatically to `limnus_ledger.jsonl`.

## ğŸ› Troubleshooting

- If imports fail, ensure stubs are generated by using the menu runner (`./run_test.sh`) which calls `grpc_tools.protoc` into `protos/` within a venv.
- â€œConnection refusedâ€: start mocks first (menu option 1) or use option 4.

## ğŸ“š Next Steps

- Swap the simulated SIGPRINT with the real `agents/sigprint/sigprint_agent.py`.
- Connect to production Limnus/Garden services.
- Add WebSocket/GUI viewer for live ledger and events.

